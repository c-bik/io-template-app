#!/bin/zsh

set -e

# ------------------------------------------------------------------------------
#
# run_io_template_app.zsh: Process IO-TEMPLATE-APP tasks.
#
# ------------------------------------------------------------------------------

if [[ -z "${ENV_FOR_DYNACONF}" ]]; then
    export ENV_FOR_DYNACONF=prod
fi

export PYTHONPATH=.

rm -f logging_io_aero.log

print "\n================================================================================"
print "\nStart $0"
print "\n--------------------------------------------------------------------------------"
print "\nIO_TEMPLATE_APP - Template Application."
print "\n--------------------------------------------------------------------------------"
print "\nENVIRONMENT_TYPE : ${ENV_FOR_DYNACONF}"
print "\nPYTHONPATH       : ${PYTHONPATH}"
print "\n--------------------------------------------------------------------------------"
date +"DATE TIME : %d.%m.%Y %H:%M:%S"
print "\n================================================================================"

if ! ( pipenv run python scripts/launcher.py ); then
    exit 255
fi

print "\n--------------------------------------------------------------------------------"
date +"DATE TIME : %d.%m.%Y %H:%M:%S"
print "\n--------------------------------------------------------------------------------"
print "\nEnd   $0"
print "\n================================================================================"
